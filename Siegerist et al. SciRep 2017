run("Grays");
run("Set Scale...", "distance=31.0154 known=1 pixel=1 unit=micron global"); //run("Brightness/Contrast...");
setMinAndMax(0, 4500);
run("Copy");
dir = getDirectory("Image"); name=getTitle; path=dir+name;
getDateAndTime(year, month, dayOfWeek, dayOfMonth, hour, minute, second, msec);
TimeString ="";
if (hour<10) {TimeString = TimeString+"0";} TimeString = TimeString+hour+"_";
if (minute<10) {TimeString = TimeString+"0";} TimeString = TimeString+minute+"_";
if (second<10) {TimeString = TimeString+"0";} TimeString = TimeString+second; measurementID = TimeString;
name = getTitle;
dotIndex = indexOf(name, ".");
title = substring(name, 0, dotIndex);
newImage("name", "8-bit black", 2430, 2430, 1);
run("Paste");
run("Measure");
run("Ridge Detection", "line_width=3.5 high_contrast=230 low_contrast=87 correct_position add_to_manager method_for_overlap_resolution=NONE sigma=1.51 lower_threshold=3.06 upper_threshold=7.99"); waitForUser("Check for correct Ridge Detection");
saveAs("Jpeg", title + measurementID); roiManager("Measure");
name = title + measurementID + ".xls"; saveAs("Measurements", dir+name);
String.copyResults(); IJ.deleteRows(0, 3000); roiManager("Delete"); run("Close"); run("Close");
